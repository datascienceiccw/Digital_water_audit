{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mx-auto px-4 py-8 bg-light">
    <div class="w-full">
        <h2 class="text-center text-4xl font-bold text-blue-600 mb-10">Tanks and Capacities</h2>
        <p class="text-gray-600 mb-5">
            <strong>How to fill this form?</strong> First, select the name of the tank used, and corresponding to that tank, enter the storage capacity.
        </p>
        <div class="flex flex-wrap -mx-4">
            <div class="w-full md:w-1/2 px-4 mb-8">
                <form method="POST" action="" class="bg-white p-8 rounded-lg shadow-xl border border-gray-200 relative">
                    {% csrf_token %}
                    <h3 class="text-lg font-semibold text-blue-500 mb-6">Add Tank Names</h3>
                    <div class="mb-6">
                        <div class="space-y-4">
                            {% for name in tank_names %}
                            <button type="button" onclick="addInput('{{ name }}', this)" class="btn btn-info w-full" value="{{ name }}">{{ name }}</button>
                            {% endfor %}
                        </div>    
                        <div id="inputs"></div>
                    </div>
                    <div class="text-end">
                        <button type="submit" class="btn btn-primary">Update</button>
                    </div>
                </form>
            </div>
        
            <div class="w-full md:w-1/2 px-4 mb-8">
                <div class="bg-white p-8 rounded-lg shadow-xl border border-gray-200 relative">
                    {% if all_tanks|length %}
                        <a href="{% url 'delete_tanks_capacities' %}" class="btn btn-danger absolute right-0 top-0 m-2">Reset</a>
                    {% endif %}
                    <h3 class="text-lg font-semibold text-blue-500 mb-6">Existing Tanks</h3>
                    {% if all_tanks|length %}
                        <ul class="list-group">
                            {% for tank in all_tanks %}
                                <li class="list-group-item flex justify-between items-center">
                                    <span>{{ tank.name }}</span>
                                    <span class="badge bg-primary rounded-full px-4">{{ tank.capacity }}</span>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-secondary mb-4">No tank added yet</p>
                    {% endif %}
                </div>    
            </div>
        </div>
        
        <div class="flex justify-between mt-8">
            <a href="{% url 'source_water_profile' %}" class="btn btn-primary px-5">Previous</a>
            <a href="{% url 'fresh_water_treatment_profile' %}" class="btn btn-primary px-5">Next</a>
        </div> 
    </div>
</div>

<script>
    function addInput(buttonValue, buttonElement) {
        const inputGroup = document.createElement('div');
        inputGroup.classList.add('mb-4', 'bg-gray-100', 'p-4', 'rounded');
        inputGroup.innerHTML = `
            <label class="block text-gray-700 text-sm font-bold mb-2">${buttonValue} Capacity</label>
            <input type="text" name="capacity" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2">
            <input type="hidden" name="name" value="${buttonValue}">
        `;
        buttonElement.parentNode.insertBefore(inputGroup, buttonElement.nextSibling);
    }
</script>
{% endblock %}
